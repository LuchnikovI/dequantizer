## Description
This is the code that was used to perform numerical experiments in [Large-scale quantum annealing simulation with tensor networks and belief propagation](https://arxiv.org/abs/2409.12240) paper.

## How to run experiments
To run numerical experiments you need to have Docker on your machine and standard shell interpreter. Docker is necessary since some complicated dependencies are being installed. 

- To run the larges QUBO experiment, execute `./ci/run_largest_qubo.sh`. It could require a lot of RAM (>32GB, more likely because of enormous computational graph generated by jax, but exact reason is still unclear for me);
- To run MAXCUT experiment, execute `./ci/run_maxcut.sh`;
- To run many small experiments that later can be compared with exact simulation, execute `./ci/run_exact_validation.sh` and `run_validation_in_time.sh`.

Numerical results are saved in HDF5 format in `./output/qbp` directory with corresponding time tags.

Note, that these scripts perform only BP based quantum annealing simulation, they do not perform exact simulation, nor run MQLib heuristics, nor run SimCim.

To run SimCim solver over numerical results/task instances generated by scripts above execute `./ci/runner.sh simcim +qbp_result_path=./output/qbp/<path-to-particular-experiment>`

To run MQLib solvers over numerical results/task instances generated by scripts above execute `./ci/runner.sh mqlib +qbp_result_path=./output/qbp/<path-to-particular-experiment>`

To run exact quantum annealing simulation over numerical results/task instances generated by scripts above execute `./ci/runner.sh exact +qbp_result_path=./output/qbp/<path-to-particular-experiment>`

## How to access numerical results
See `./explore_numerical_results.ipynb` for a template of how to open and explore numerical results

## Experiment configurations
Some of the numerical experiment configs are available in `./configs` (see documentation of [Hydra](https://hydra.cc/) for more details on the config structure). Names of configs and their fields a self explanatory.

## How to run custom experiments
To run custom numerical experiments use `./ci/runner.sh`. Execute `./ci/runner.sh help` to get description.
You can create new configs in `./configs` folder or modify existing one and execute corresponding experiments with `./ci/runner.sh` script.

An example of how to run a custom small numerical experiment for debugging purposes:
`.ci/runner.sh
    qbp 
    task_generator=debug_small_random_regular
    quantum_annealing_schedule=linear_wo_sampling`
    
where we override some of the subconfigs by predefined ones in `.configs` directory.

## Plotting
There is a number of `.ipynb` files with plotting scripts where it is typically enough to set the path to the directory with numerical results to get plots. But they are written in a hurry and for particular numerical data, so it is better to write your own plotters for custom numerical experiments.
